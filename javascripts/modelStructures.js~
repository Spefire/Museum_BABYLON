var epaisseurMur = 0.1;
var hauteurMur = 3.0;
var epaisseurSol = 0.1;
var detailsTexture = 2.5;

function createMuseum(scene){
  
  var offset = hauteurMur*0.0;
  //---Rez de chaussée
  //Murs extérieurs
  createFloor(0,offset-hauteurMur/2,0,30,epaisseurSol,30);
  createWall(15,offset,0,true,30,hauteurMur,epaisseurMur,false) ;
  createWall(-15,offset,0,true,30,hauteurMur,epaisseurMur,false) ;
  createWall(0,offset,15,false,30,hauteurMur,epaisseurMur,false) ;
  createWall(8,offset,-15,false,14,hauteurMur,epaisseurMur,false) ;
  createWall(-8,offset,-15,false,14,hauteurMur,epaisseurMur,false) ;
  createDoor(0.5,offset,-15,false,1,hauteurMur,epaisseurMur,false);
  createDoor(-0.5,offset,-15,false,1,hauteurMur,epaisseurMur,false);
  
  //Murs et portes intérieures sur X
  createWall(-11.5,offset,0,false,7,hauteurMur,epaisseurMur,true) ;
  createDoor(-7.5,offset,0,false,1,hauteurMur,epaisseurMur,true);
  createWall(-3.75,offset,0,false,6.5,hauteurMur,epaisseurMur,true) ;
  createDoor(0,offset,0,false,1,hauteurMur,epaisseurMur,true);
  createWall(3.75,offset,0,false,6.5,hauteurMur,epaisseurMur,true) ;
  createDoor(7.5,offset,0,false,1,hauteurMur,epaisseurMur,true);
  createWall(11.5,offset,0,false,7,hauteurMur,epaisseurMur,true) ;
  
  //Murs et portes extérieures sur Z
  createWall(-5,offset,14,true,2,hauteurMur,epaisseurMur,true) ;
  createDoor(-5,offset,12.5,true,1,hauteurMur,epaisseurMur,true);
  createWall(-5,offset,6,true,12,hauteurMur,epaisseurMur,true) ;
  createWall(5,offset,9,true,12,hauteurMur,epaisseurMur,true) ;
  createDoor(5,offset,2.5,true,1,hauteurMur,epaisseurMur,true);
  createWall(5,offset,1,true,2,hauteurMur,epaisseurMur,true) ;

  createStairs(13,offset,-3.5,4,hauteurMur,5) ;
  createElevator(-13,offset,-2,4,hauteurMur,epaisseurMur, 4);

  offset = hauteurMur*1.0;
  //--Etage 1
  createFloor(0,offset-hauteurMur/2,7.5,30,epaisseurSol,15);
  createFence(0,offset-hauteurMur/4,0,false,22,hauteurMur/2);
  createWall(15,offset,0,true,30,hauteurMur,epaisseurMur,false) ;
  createWall(-15,offset,0,true,30,hauteurMur,epaisseurMur,false) ;
  createWall(0,offset,15,false,30,hauteurMur,epaisseurMur,false) ;
  createWall(0,offset,-15,false,30,hauteurMur,epaisseurMur,false) ;

  offset = hauteurMur*2.0;
  //--Etage 2
  createWall(15,offset,0,true,30,hauteurMur,epaisseurMur,false) ;
  createWall(-15,offset,0,true,30,hauteurMur,epaisseurMur,false) ;
  createWall(0,offset,15,false,30,hauteurMur,epaisseurMur,false) ;
  createWall(0,offset,-15,false,30,hauteurMur,epaisseurMur,false) ;

  offset = hauteurMur*3.0;
  //--Toit
//   createRoof(0,offset-hauteurMur*0.5,0,30,epaisseurSol,30);

  return scene;
}

function createWall(x, y, z, vertical, width, height, depth, interieur, scene) {

  var wall = BABYLON.MeshBuilder.CreateBox("wall", {width: width, height: height, depth: depth}, scene);
  wall.position = new BABYLON.Vector3(x,y,z) ;
  wall.checkCollisions = true;
  var mat = new BABYLON.StandardMaterial("materiau_mur",scene);
  if (interieur) {
    mat.diffuseTexture = new BABYLON.Texture("assets/textures/mur1.jpg",scene);
  } else {
    mat.diffuseTexture = new BABYLON.Texture("assets/textures/mur.jpg",scene);
  }
  mat.diffuseTexture.uScale = width/detailsTexture;
  mat.diffuseTexture.vScale = 1.0;
  wall.material = mat;
  if (vertical) {
    setRotation(wall,0,90,0);
  }
  return wall;
}

function createFence(x, y, z, vertical, width, height, scene) {

  var fence = BABYLON.MeshBuilder.CreatePlane("fence", {width: width, height: height, sideOrientation:BABYLON.Mesh.DOUBLESIDE}, scene);
  fence.position = new BABYLON.Vector3(x,y,z) ;
  fence.checkCollisions = true;
  var mat = new BABYLON.StandardMaterial("materiau_barriere",scene);
  mat.diffuseTexture = new BABYLON.Texture("assets/textures/fence.png",scene);
  mat.diffuseTexture.uScale = width/detailsTexture;
  mat.diffuseTexture.vScale = 1.0;
  mat.diffuseTexture.hasAlpha = true;
  fence.material = mat;
  if (vertical) {
    setRotation(fence,0,90,0);
  }
  return fence;
}

function createFloor(x, y, z, width, height, depth, scene) {

  var floor = BABYLON.MeshBuilder.CreateBox("floor", {width: width, height: height, depth: depth}, scene);
  floor.position = new BABYLON.Vector3(x,y,z) ;
  floor.checkCollisions = true;
  var mat = new BABYLON.StandardMaterial("materiau_parquet",scene);
  mat.diffuseTexture = new BABYLON.Texture("assets/textures/parquet.jpg",scene);
  mat.diffuseTexture.uScale = width/detailsTexture;
  mat.diffuseTexture.vScale = width/detailsTexture;
  floor.material = mat;
  return floor;
}

function createDoor(x, y, z, vertical, width, height, depth, interieur, scene) {

  var wall = BABYLON.MeshBuilder.CreateBox("wall", {width: width, height: height*0.2, depth: depth}, scene);
  wall.position = new BABYLON.Vector3(x,y+0.4*height,z) ;
  var mat = new BABYLON.StandardMaterial("materiau_mur",scene);
  if (interieur) {
    mat.diffuseTexture = new BABYLON.Texture("assets/textures/mur1.jpg",scene);
  } else {
    mat.diffuseTexture = new BABYLON.Texture("assets/textures/mur.jpg",scene);
  }
  mat.diffuseTexture.uScale = width/detailsTexture;var door = 
  mat.diffuseTexture.vScale = 0.2;
  wall.material = mat;

  var door = BABYLON.MeshBuilder.CreateBox("door", {width: width, height: height*0.8, depth: depth}, scene);
  door.position = new BABYLON.Vector3(x,y-0.1*height,z) ;
  mat = new BABYLON.StandardMaterial("materiau_porte",scene);
  mat.diffuseTexture = new BABYLON.Texture("assets/textures/door01.jpg",scene);
  mat.diffuseTexture.uScale = 1.0;
  mat.diffuseTexture.vScale = 1.0;
  door.material = mat;

  if (vertical) {
    setRotation(wall,0,90,0);
    setRotation(door,0,90,0);
  }
  return door;
}

function createStairs(x, y, z, width, height, depth, scene) {
  var nbMarches = 15;
  for (var i = 1; i <= nbMarches; i++) {
    var stairs = BABYLON.MeshBuilder.CreateBox("stairs", {width: width, height: i*height/nbMarches, depth: depth/nbMarches}, scene);
    var posY = y-((nbMarches-i)/nbMarches)*(height/2);
    var posZ = z+depth*((i-1)/nbMarches-1/4);
    
    stairs.position = new BABYLON.Vector3(x,posY,posZ) ;
    stairs.checkCollisions = true;
    var mat = new BABYLON.StandardMaterial("materiau_escaliers",scene);
    mat.diffuseTexture = new BABYLON.Texture("assets/textures/parquet1.jpg",scene);
    mat.diffuseTexture.uScale = width/detailsTexture;
    mat.diffuseTexture.vScale = width/detailsTexture;
    stairs.material = mat;
  }
}

function createRoof(x, y, z, width, height, depth, scene) {

  var roof = BABYLON.MeshBuilder.CreateBox("roof", {width: width, height: height, depth: depth}, scene);
  roof.position = new BABYLON.Vector3(x,y,z) ;
  var mat = new BABYLON.StandardMaterial("materiau_toit",scene);
  mat.diffuseTexture = new BABYLON.Texture("assets/textures/toit.jpg",scene);
  mat.diffuseTexture.uScale = width/detailsTexture;
  mat.diffuseTexture.vScale = width/detailsTexture;
  roof.material = mat;
  return roof;
}

function createElevator(x, y, z, width, height, tickness, depth, scene) {

  createWall(x-width/4-0.25,y,z-depth/2,false,width/2-0.5,height,tickness,false) ;//DONE
  createDoor(x,y,z-depth/2,false,1.0,hauteurMur,epaisseurMur,false);
  createWall(x+width/4+0.25,y,z-depth/2,false,width/2-0.5,height,tickness,false) ;//DONE
  createWall(x,y+height,z-depth/2,false,width,height,tickness,false) ;//DONE

  createWall(x-width/4-0.25,y+height,z+depth/2,false,width/2-0.5,height,tickness,false) ;//DONE
  createDoor(x,y+height,z+depth/2,false,1.0,hauteurMur,epaisseurMur,false);
  createWall(x+width/4+0.25,y+height,z+depth/2,false,width/2-0.5,height,tickness,false) ;//DONE

  createWall(x+width/2,y,z,true,width,height,tickness,false) ;
  createWall(x+width/2,y+height,z,true,width,height,tickness,false) ;

  createFloor(x,y+height/2,z,width,epaisseurSol,depth);
}